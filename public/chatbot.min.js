window.ChatbotService=class{constructor(t){if(!t.clientId)throw new Error("Client ID is required");this.clientId=t.clientId,this.apiUrl=t.apiUrl||"https://api.yourdomain.com/api/v1",this.position=t.position||"bottom-right",this.theme=t.theme||{primaryColor:"#007bff",backgroundColor:"#ffffff",textColor:"#000000"},this.initialize()}initialize(){this.container=document.createElement("div"),this.container.id="chatbot-container",this.container.style.cssText=`position:fixed;${this.position.includes("bottom")?"bottom:20px;":"top:20px;"}${this.position.includes("right")?"right:20px;":"left:20px;"}z-index:1000;display:flex;flex-direction:column;`,this.button=document.createElement("button"),this.button.id="chatbot-button",this.button.innerHTML="ðŸ’¬",this.button.style.cssText=`width:60px;height:60px;border-radius:50%;background-color:${this.theme.primaryColor};border:none;color:white;font-size:24px;cursor:pointer;box-shadow:0 2px 10px rgba(0,0,0,0.2);align-self:flex-end;`,this.chatWindow=document.createElement("div"),this.chatWindow.id="chatbot-window",this.chatWindow.style.cssText=`display:none;width:350px;height:500px;background:${this.theme.backgroundColor};border-radius:10px;margin-bottom:10px;box-shadow:0 2px 10px rgba(0,0,0,0.1);overflow:hidden;flex-direction:column;`;const t=document.createElement("div");t.style.cssText=`padding:15px;background:${this.theme.primaryColor};color:white;font-weight:bold;`,t.textContent="Chat Assistant",this.messagesContainer=document.createElement("div"),this.messagesContainer.style.cssText="flex:1;overflow-y:auto;padding:15px;";const e=document.createElement("div");e.style.cssText="padding:15px;border-top:1px solid #eee;display:flex;",this.input=document.createElement("input"),this.input.type="text",this.input.placeholder="Type your message...",this.input.style.cssText="flex:1;padding:8px;border:1px solid #ddd;border-radius:20px;margin-right:8px;";const s=document.createElement("button");s.innerHTML="âž¤",s.style.cssText=`background:${this.theme.primaryColor};color:white;border:none;border-radius:50%;width:35px;height:35px;cursor:pointer;`,e.appendChild(this.input),e.appendChild(s),this.chatWindow.appendChild(t),this.chatWindow.appendChild(this.messagesContainer),this.chatWindow.appendChild(e),this.container.appendChild(this.chatWindow),this.container.appendChild(this.button),document.body.appendChild(this.container),this.button.addEventListener("click",()=>this.toggleChat()),s.addEventListener("click",()=>this.sendMessage()),this.input.addEventListener("keypress",t=>{"Enter"===t.key&&this.sendMessage()})}toggleChat(){this.chatWindow.style.display="none"===this.chatWindow.style.display?"flex":"none","flex"===this.chatWindow.style.display&&this.input.focus()}async sendMessage(){const t=this.input.value.trim();if(!t)return;this.input.value="",this.addMessage("user",t);try{const e=await fetch(`${this.apiUrl}/query/ask`,{method:"POST",headers:{"Content-Type":"application/json","X-Client-ID":this.clientId},body:JSON.stringify({query:t})}),s=await e.json();if("SUCCESS"===s.status)this.addMessage("bot",s.answer);else throw new Error(s.message||"Failed to get response")}catch(t){this.addMessage("error","Sorry, I encountered an error. Please try again."),console.error("Chatbot error:",t)}}addMessage(t,e){const s=document.createElement("div");s.style.cssText=`margin:8px 0;padding:8px 12px;border-radius:20px;max-width:80%;word-wrap:break-word;${"user"===t?`background:${this.theme.primaryColor};color:white;align-self:flex-end;margin-left:auto;`:"error"===t?"background:#ff4444;color:white;":`background:#f1f1f1;color:${this.theme.textColor};`}`,s.textContent=e,this.messagesContainer.appendChild(s),this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight}} 